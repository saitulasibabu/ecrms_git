<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:context="http://www.springframework.org/schema/context"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">
      <context:annotation-config />
      <context:component-scan base-package="com.vwoa.ecrms" />
      
    <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
       	<property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
  		<property name="location" value="classpath:ecrms_config_${env.was.ecrms}.properties"/>
 	</bean>
 	
 	
 	
 	<!-- creates a java.util.Map instance with values loaded from the supplied 'sourceMap' -->
    <bean id="globals" class="org.springframework.beans.factory.config.MapFactoryBean">
       <property name="sourceMap">
           <map>
             <entry key="environment" value="${env.was.ecrms}"/>
           </map>
       </property>
    </bean>
            
      
    <!-- DB configuration xml -->
	<import resource="applicationContext-db.xml"/>
	 
	<bean id="pfxFileLocation" class="java.lang.String">
		<constructor-arg value="${pfx.file.location}" /> 
	</bean>	
	<bean id="certificateFileExtension" class="java.lang.String">
		<constructor-arg value="${certificate.file.extension}" /> 
	</bean>	

	<bean id="marshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
	      <property name="classesToBeBound">
            <list>
                <value>com.vwoa.ecrms.model.webservice.CreateCertificateRequest</value>
                <value>com.vwoa.ecrms.model.webservice.CertificateRequestModel</value>
                <value>com.vwoa.ecrms.model.webservice.CertificateRevokeRequest</value>
                <value>com.vwoa.ecrms.model.webservice.CertificateRevokeRequestModel</value>
            </list>
        </property>
	</bean>
	
	<bean id="unmarshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
	      <property name="classesToBeBound">
            <list>
                <value>com.vwoa.ecrms.model.webservice.CreateCertificateResponse</value>
                <value>com.vwoa.ecrms.model.webservice.CertificateResponseModel</value>
                <value>com.vwoa.ecrms.model.webservice.CertificateRevokeResponse</value>
                <value>com.vwoa.ecrms.model.webservice.CertificateRevokeResponseModel</value>
            </list>
           </property>
	</bean>
	 	
	<bean id="webServiceTemplate" class="org.springframework.ws.client.core.WebServiceTemplate">
		<property name="defaultUri"	value="${ca.webservice.uri}"/>
		<property name="marshaller" ref="marshaller"/>
		<property name="unmarshaller" ref="unmarshaller"/>
	</bean>


<!-- Email Beans -->
	<bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
	  <property name="host" value="${mail.smtp.host}"/>
	</bean>

	<!-- this is a template message that we can pre-load with default state -->
	<bean id="templateMessage" class="org.springframework.mail.SimpleMailMessage"/>
	
	  
</beans>


